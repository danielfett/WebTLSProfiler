<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="theme-color" content="#6200EE">

    <title>Web TLS Profiler</title>

    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css">

    <!-- jQuery library -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

    <!-- Popper JS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>

    <!-- Latest compiled JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"></script>

    <!-- Material design library -->
    <link href="https://unpkg.com/material-components-web@v4.0.0/dist/material-components-web.min.css" rel="stylesheet">
    <script src="https://unpkg.com/material-components-web@v4.0.0/dist/material-components-web.min.js"></script>
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
</head>

<body>
    <header class="mdc-top-app-bar">
      <div class="mdc-top-app-bar__row">
        <section class="mdc-top-app-bar__section mdc-top-app-bar__section--align-start">
          <span class="mdc-top-app-bar__title">Web TLS Profiler</span>
        </section>
      </div>
    </header>

    <div class="row custom-row mdc-top-app-bar--fixed-adjust">
        <div class="coll-md-12 col-lg-6 custom-col">
            <div class="mdc-card custom-card">
                <p>The <strong>Web TLS Profiler</strong> is a web interface for the TLS Profiler Python package.
                    The TLS Profiler scans the TLS settings of a webserver and compares the configuration with a
                    Mozilla TLS Profile. <br>There are three different profiles that have different security levels and
                    different range of client support. The Old profile has the best support for legacy clients and
                    the Modern profile provides the highest level of security. You can find a detailed description of
                    the profiles on the Mozilla wiki page
                    <a href="https://wiki.mozilla.org/Security/Server_Side_TLS" target="_blank">Security/Server Side TLS</a>.
                    <br>Just enter your domain address in the form field and choose a profile from the dropdown menu.
                </p>
                <div class="alert alert-warning">
                    <p><strong>Note:</strong> You have to own the server you want to scan.</p>
                </div>
            </div>
        </div>
        <div class="coll-md-12 col-lg-6 custom-col">
            <div class="mdc-card custom-card">
                <h2>Run TLS Profiler Scan</h2>
                <label class="mdc-text-field custom-form">
                    <div class="mdc-text-field__ripple"></div>
                    <input id="domain" class="mdc-text-field__input" type="text" aria-labelledby="my-label-id">
                    <span class="mdc-floating-label" id="my-label-id">Enter domain</span>
                    <div class="mdc-line-ripple"></div>
                </label>

                <div class="mdc-select custom-form">
                    <div class="mdc-select__anchor profile-select">
                        <i class="mdc-select__dropdown-icon"></i>
                        <div class="mdc-select__selected-text"></div>
                        <span class="mdc-floating-label">Choose a Mozilla TLS Profile:</span>
                        <div class="mdc-line-ripple"></div>
                    </div>

                    <div class="mdc-select__menu mdc-menu mdc-menu-surface demo-width-class">
                        <ul class="mdc-list">
                            <li class="mdc-list-item" data-value="modern" aria-selected="true">
                                Modern
                            </li>
                            <li class="mdc-list-item" data-value="intermediate">
                                Intermediate
                            </li>
                            <li class="mdc-list-item" data-value="old">
                                Old
                            </li>
                        </ul>
                    </div>
                </div>

                <button class="mdc-button mdc-button--raised custom-form" onclick="submit()">
                    <div class="mdc-button__ripple"></div>
                    <span class="mdc-button__label">Submit</span>
                </button>
            </div>
        </div>
    </div>

    <h2 class="title">Results</h2>
    <div class="row custom-row">
        <div class="col-md-12 col-lg-6 col-xl-3 custom-col">
            <div class="mdc-card custom-card">
                <h3>Profile Errors</h3>
                <ul>
                {% if result.profile_errors %}
                {% for res in result.profile_errors %}
                    <li>{{ res }}</li>
                {% endfor %}
                {% else %}
                    <li>All good ;)</li>
                {% endif %}
                </ul>
            </div>
        </div>
        <div class="col-md-12 col-lg-6 col-xl-3 custom-col">
            <div class="mdc-card custom-card">
            <h3>Validation Errors</h3>
                <ul>
                {% if result.validation_errors %}
                {% for res in result.validation_errors %}
                    <li>{{ res }}</li>
                {% endfor %}
                {% else %}
                    <li>All good ;)</li>
                {% endif %}
                </ul>
            </div>
        </div>
        <div class="col-md-12 col-lg-6 col-xl-3 custom-col">
            <div class="mdc-card custom-card">
                <h3>Certificate Warnings</h3>
                <ul>
                {% if result.cert_warnings %}
                {% for res in result.cert_warnings %}
                    <li>{{ res }}</li>
                {% endfor %}
                {% else %}
                    <li>All good ;)</li>
                {% endif %}
                </ul>
            </div>
        </div>
        <div class="col-md-12 col-lg-6 col-xl-3 custom-col">
            <div class="mdc-card custom-card">
                <h3>Vulnerability Errors</h3>
                <ul>
                {% if result.vulnerability_errors %}
                {% for res in result.vulnerability_errors %}
                    <li>{{ res }}</li>
                {% endfor %}
                {% else %}
                    <li>All good ;)</li>
                {% endif %}
                </ul>
            </div>
        </div>
    </div>
    <h2 class="title">About</h2>
    <div class="row custom-row">
        <div class="col-md-12 col-lg-6 col-xl-3 custom-col">
            <div class="mdc-card custom-card">
                <p>The TLS Profiler was developed by Daniel Fett and Fabian Hauck.
                    You can find it's source code on <a href="https://github.com/danielfett/tlsprofiler" target="_blank">GitHub</a>.
                    This website was created by Fabian Hauck.</p>
            </div>
        </div>
    </div>
</body>

<script>
    mdc.autoInit();
    mdc.select.MDCSelect.attachTo(document.querySelector('.mdc-select'));
    mdc.textField.MDCTextField.attachTo(document.querySelector('.mdc-text-field'));

    const profile = new mdc.select.MDCSelect(document.querySelector(".mdc-select"));
    const domain = new mdc.textField.MDCTextField(document.querySelector('.mdc-text-field'));

    function submit() {
        domain_value = document.getElementById("domain").value;
        window.location.href = "/?domain="+domain_value+"&profile="+profile.value;
    }
</script>

<style>
    body {
        background-color: #fafafa;
    }
    .custom-card {
        margin-top: 10px;
        padding: 5px;
        height: 100%;
    }
    .custom-col {
        margin-bottom: 20px;
    }
    .custom-row {
        margin-left: 1px;
        margin-right: 1px;
    }
    .custom-form {
        margin-top: 10px;
        margin-bottom: 10px;
        margin-left: 10px;
        max-width: 400px;
    }
    .profile-select {
        width: 400px;
    }
    .title {
        margin-top: 25px;
        margin-left: 20px;
    }
</style>

</html>
